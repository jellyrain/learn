"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[611],{3905:function(t,e,n){n.d(e,{Zo:function(){return m},kt:function(){return c}});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var i=a.createContext({}),u=function(t){var e=a.useContext(i),n=e;return t&&(n="function"==typeof t?t(e):l(l({},e),t)),n},m=function(t){var e=u(t.components);return a.createElement(i.Provider,{value:e},t.children)},s={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},k=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,i=t.parentName,m=p(t,["components","mdxType","originalType","parentName"]),k=u(n),c=r,b=k["".concat(i,".").concat(c)]||k[c]||s[c]||o;return n?a.createElement(b,l(l({ref:e},m),{},{components:n})):a.createElement(b,l({ref:e},m))}));function c(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,l=new Array(o);l[0]=k;var p={};for(var i in e)hasOwnProperty.call(e,i)&&(p[i]=e[i]);p.originalType=t,p.mdxType="string"==typeof t?t:r,l[1]=p;for(var u=2;u<o;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},51997:function(t,e,n){n.r(e),n.d(e,{assets:function(){return m},contentTitle:function(){return i},default:function(){return c},frontMatter:function(){return p},metadata:function(){return u},toc:function(){return s}});var a=n(83117),r=n(80102),o=(n(67294),n(3905)),l=["components"],p={sidebar_position:4},i=void 0,u={unversionedId:"Hadoop/MapReduce/InputFormat\u6570\u636e\u8f93\u5165",id:"Hadoop/MapReduce/InputFormat\u6570\u636e\u8f93\u5165",title:"InputFormat\u6570\u636e\u8f93\u5165",description:"1. \u5207\u7247\u4e0eMapTask\u5e76\u884c\u5ea6\u51b3\u5b9a\u673a\u5236\uff1a",source:"@site/docs\\8-Hadoop\\6-MapReduce\\InputFormat\u6570\u636e\u8f93\u5165.md",sourceDirName:"8-Hadoop/6-MapReduce",slug:"/Hadoop/MapReduce/InputFormat\u6570\u636e\u8f93\u5165",permalink:"/learn/Hadoop/MapReduce/InputFormat\u6570\u636e\u8f93\u5165",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Hadoop\u5e8f\u5217\u5316",permalink:"/learn/Hadoop/MapReduce/Hadoop\u5e8f\u5217\u5316"},next:{title:"MapReduce\u5de5\u4f5c\u6d41\u7a0b",permalink:"/learn/Hadoop/MapReduce/MapReduce\u5de5\u4f5c\u6d41\u7a0b"}},m={},s=[{value:"1. \u5207\u7247\u4e0eMapTask\u5e76\u884c\u5ea6\u51b3\u5b9a\u673a\u5236\uff1a",id:"1-\u5207\u7247\u4e0emaptask\u5e76\u884c\u5ea6\u51b3\u5b9a\u673a\u5236",level:3},{value:"2. Job\u63d0\u4ea4\u6d41\u7a0b\u6e90\u7801\u548c\u5207\u7247\u6e90\u7801\u8be6\u89e3\uff1a",id:"2-job\u63d0\u4ea4\u6d41\u7a0b\u6e90\u7801\u548c\u5207\u7247\u6e90\u7801\u8be6\u89e3",level:3},{value:"3. FileInputFormat \u5207\u7247\u673a\u5236\uff1a",id:"3-fileinputformat-\u5207\u7247\u673a\u5236",level:3},{value:"1. \u5207\u7247\u673a\u5236\uff1a",id:"1-\u5207\u7247\u673a\u5236",level:4},{value:"2. FileInputFormat \u5207\u7247\u5927\u5c0f\u7684\u53c2\u6570\u914d\u7f6e\uff1a",id:"2-fileinputformat-\u5207\u7247\u5927\u5c0f\u7684\u53c2\u6570\u914d\u7f6e",level:4},{value:"4. FileInputFormat\u5b9e\u73b0\u7c7b\uff1a",id:"4-fileinputformat\u5b9e\u73b0\u7c7b",level:3},{value:"1. TextInputFormat\uff1a",id:"1-textinputformat",level:4},{value:"2. CombineTextInputFormat\uff1a",id:"2-combinetextinputformat",level:4},{value:"3. CombineTextInputFormat \u5b9e\u6218\uff1a",id:"3-combinetextinputformat-\u5b9e\u6218",level:4},{value:"1. \u9700\u6c42\uff1a",id:"1-\u9700\u6c42",level:5},{value:"2. \u5b9e\u73b0\uff1a",id:"2-\u5b9e\u73b0",level:5}],k={toc:s};function c(t){var e=t.components,p=(0,r.Z)(t,l);return(0,o.kt)("wrapper",(0,a.Z)({},k,p,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"1-\u5207\u7247\u4e0emaptask\u5e76\u884c\u5ea6\u51b3\u5b9a\u673a\u5236"},"1. \u5207\u7247\u4e0eMapTask\u5e76\u884c\u5ea6\u51b3\u5b9a\u673a\u5236\uff1a"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u6570\u636e\u5757\uff1a"),"Block\u662fHDFS\u7269\u7406\u4e0a\u628a\u6570\u636e\u5206\u6210\u4e00\u5757\u4e00\u5757\u3002",(0,o.kt)("strong",{parentName:"p"},"\u6570\u636e\u5757\u662f HDFS \u5b58\u50a8\u6570\u636e\u5355\u4f4d")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u6570\u636e\u5207\u7247\uff1a"),"\u6570\u636e\u5207\u7247\u53ea\u662f\u5728\u903b\u8f91\u4e0a\u5bf9\u8f93\u5165\u8fdb\u884c\u5206\u7247\uff0c\u5e76\u4e0d\u4f1a\u5728\u78c1\u76d8\u4e0a\u5c06\u5176\u5207\u5206\u6210\u7247\u8fdb\u884c\u5b58\u50a8\u3002",(0,o.kt)("strong",{parentName:"p"},"\u6570\u636e\u5207\u7247\u662f MapReduce \u7a0b\u5e8f\u8ba1\u7b97\u8f93\u5165\u6570\u636e\u7684\u5355\u4f4d"),"\uff0c\u4e00\u4e2a\u5207\u7247\u4f1a\u5bf9\u5e94\u542f\u52a8\u4e00\u4e2aMapTask"),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(70620).Z,width:"1309",height:"614"})),(0,o.kt)("h3",{id:"2-job\u63d0\u4ea4\u6d41\u7a0b\u6e90\u7801\u548c\u5207\u7247\u6e90\u7801\u8be6\u89e3"},"2. Job\u63d0\u4ea4\u6d41\u7a0b\u6e90\u7801\u548c\u5207\u7247\u6e90\u7801\u8be6\u89e3\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"waitForCompletion()\n\nsubmit();\n\n// 1\u5efa\u7acb\u8fde\u63a5\n    connect();  \n        // 1\uff09\u521b\u5efa\u63d0\u4ea4Job\u7684\u4ee3\u7406\n        new Cluster(getConfiguration());\n            // \uff081\uff09\u5224\u65ad\u662f\u672c\u5730\u8fd0\u884c\u73af\u5883\u8fd8\u662fyarn\u96c6\u7fa4\u8fd0\u884c\u73af\u5883\n            initialize(jobTrackAddr, conf); \n\n// 2 \u63d0\u4ea4job\nsubmitter.submitJobInternal(Job.this, cluster)\n\n    // 1\uff09\u521b\u5efa\u7ed9\u96c6\u7fa4\u63d0\u4ea4\u6570\u636e\u7684Stag\u8def\u5f84\n    Path jobStagingArea = JobSubmissionFiles.getStagingDir(cluster, conf);\n\n    // 2\uff09\u83b7\u53d6jobid \uff0c\u5e76\u521b\u5efaJob\u8def\u5f84\n    JobID jobId = submitClient.getNewJobID();\n\n    // 3\uff09\u62f7\u8d1djar\u5305\u5230\u96c6\u7fa4\ncopyAndConfigureFiles(job, submitJobDir);   \n    rUploader.uploadFiles(job, jobSubmitDir);\n\n    // 4\uff09\u8ba1\u7b97\u5207\u7247\uff0c\u751f\u6210\u5207\u7247\u89c4\u5212\u6587\u4ef6\nwriteSplits(job, submitJobDir);\n        maps = writeNewSplits(job, jobSubmitDir);\n        input.getSplits(job);\n\n    // 5\uff09\u5411Stag\u8def\u5f84\u5199XML\u914d\u7f6e\u6587\u4ef6\nwriteConf(conf, submitJobFile);\n    conf.writeXml(out);\n\n    // 6\uff09\u63d0\u4ea4Job,\u8fd4\u56de\u63d0\u4ea4\u72b6\u6001\nstatus = submitClient.submitJob(jobId, submitJobDir.toString(), job.getCredentials());\n")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(48074).Z,width:"1303",height:"664"})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Job")," \u4e3b\u8981\u63d0\u4ea4\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"split \u6587\u4ef6\uff1a\u5207\u7247\u4fe1\u606f\uff08\u903b\u8f91\u5207\u7247\uff09"),(0,o.kt)("li",{parentName:"ol"},"xml \u6587\u4ef6\uff1a\u76f8\u5173\u53c2\u6570"),(0,o.kt)("li",{parentName:"ol"},"jar \u5305\uff1a\u9700\u8981\u7684\u5305")),(0,o.kt)("h3",{id:"3-fileinputformat-\u5207\u7247\u673a\u5236"},"3. FileInputFormat \u5207\u7247\u673a\u5236\uff1a"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5207\u7247\u4e0d\u7b49\u540c\u4e8e\u5206\u5757\uff08block\uff09\uff0cblock\u662f\u7269\u7406\u5b58\u50a8\u5c42\u9762\u4e0a\u7684\u6982\u5ff5\uff0c\u800c\u5207\u7247\uff08split\uff09\u662f\u903b\u8f91\u5c42\u9762\u4e0a\u7684\u6982\u5ff5\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5207\u7247\u540e\uff0c\u6587\u4ef6\u5757\u5b58\u50a8\u7684\u4f4d\u7f6e\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8\uff0c\u5757\u4e5f\u4e0d\u4f1a\u88ab\u5207\u5f00\uff0c\u4e00\u4e2a\u6587\u4ef6\u88ab\u5207\u7247\u540e\uff0c\u4f1a\u751f\u6210\u4e00\u7ec4\u7d22\u5f15\uff0c\u6765\u8868\u793a\u5207\u7247\u7684\u7ed3\u679c\u3002")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u6bd4\u5982\u4e00\u4e2a300MB\u5927\u5c0f\u7684\u6587\u4ef6\uff0cblocksize \u4e3a128MB\u3002\u5207\u7247\u89c4\u5219\u5148\u6309 128MB \u6765\u7b97\uff08\u5207\u7247\u89c4\u5219\u6709\u4e0d\u540c\u7684\u7b56\u7565\u53ef\u4ee5\u9009\u62e9\uff09\u3002\u90a3\u4e48\u4f1a\u521b\u5efa\u5982\u4e0b\u8fd9\u6837\u7684\u7d22\u5f15\uff0c\u5e76\u52a0\u4ee5\u4e34\u65f6\u4fdd\u5b58\u3002"),(0,o.kt)("p",{parentName:"blockquote"},"\u5207\u72471\uff1a0~128MB"),(0,o.kt)("p",{parentName:"blockquote"},"\u5207\u72472\uff1a128~256MB"),(0,o.kt)("p",{parentName:"blockquote"},"\u5207\u72473\uff1a256~300MB")),(0,o.kt)("h4",{id:"1-\u5207\u7247\u673a\u5236"},"1. \u5207\u7247\u673a\u5236\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u7b80\u5355\u7684\u6309\u7167\u6587\u4ef6\u7684\u5185\u5bb9\u957f\u5ea6\u8fdb\u884c\u5207\u7247"),(0,o.kt)("li",{parentName:"ol"},"\u5207\u7247\u5927\u5c0f\uff0c",(0,o.kt)("strong",{parentName:"li"},"\u9ed8\u8ba4\u7b49\u4e8e Block \u5927\u5c0f")),(0,o.kt)("li",{parentName:"ol"},"\u5207\u7247\u65f6\u4e0d\u8003\u8651\u6570\u636e\u96c6\u6574\u4f53\uff0c\u800c\u662f\u9010\u4e2a\u9488\u5bf9\u6bcf\u4e00\u4e2a\u6587\u4ef6\u5355\u72ec\u5207\u7247"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u6bcf\u6b21\u5207\u7247\u65f6\uff0c\u90fd\u8981\u5224\u65ad\u5207\u5b8c\u5269\u4e0b\u7684\u90e8\u5206\u662f\u5426\u5927\u4e8e\u5757\u76841.1\u500d\uff0c\u4e0d\u5927\u4e8e1.1\u500d\u5c31\u5212\u5206\u4e00\u5757\u5207\u7247"))),(0,o.kt)("h4",{id:"2-fileinputformat-\u5207\u7247\u5927\u5c0f\u7684\u53c2\u6570\u914d\u7f6e"},"2. FileInputFormat \u5207\u7247\u5927\u5c0f\u7684\u53c2\u6570\u914d\u7f6e\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u6e90\u7801\u4e2d\u8ba1\u7b97\u5207\u7247\u5927\u5c0f\u7684\u516c\u5f0f\uff1a")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"Math.max(minSize, Math.min(maxSize, blockSize));\n\n// \u9ed8\u8ba4\u503c\u4e3a 1\nmapreduce.input.fileinputformat.split.minsize=1;\n\n// \u9ed8\u8ba4\u503c\u4e3a Long.MAXValue Long\u7684\u6700\u5927\u503c\nmapreduce.input.fileinputformat.split.maxsize=Long.MAXValue\n")),(0,o.kt)("p",null,"\u6240\u4ee5\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c",(0,o.kt)("strong",{parentName:"p"},"\u5207\u7247\u5927\u5c0f = blocksize\uff08\u5757\u5927\u5c0f\uff09")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"\u5207\u7247\u5927\u5c0f\u7684\u8bbe\u7f6e\uff1a",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"maxsize\uff08\u5207\u7247\u7684\u6700\u5927\u503c\uff09\uff1a",(0,o.kt)("strong",{parentName:"li"},"\u53c2\u6570\u5982\u679c\u8c03\u5f97\u6bd4 blockSize \u5c0f"),"\uff0c\u5219\u4f1a\u8ba9\u5207\u7247\u53d8\u5c0f\uff0c\u800c\u4e14\u5c31\u7b49\u4e8e\u5f53\u524d\u914d\u7f6e\u7684\u8fd9\u4e2a\u53c2\u6570\u7684\u503c"),(0,o.kt)("li",{parentName:"ol"},"minsize\uff08\u5207\u7247\u7684\u6700\u5c0f\u503c\uff09\uff1a",(0,o.kt)("strong",{parentName:"li"},"\u53c2\u6570\u5982\u679c\u8c03\u7684\u6bd4 blockSize \u5927"),"\uff0c\u5219\u4f1a\u8ba9\u5207\u7247\u53d8\u5927\uff0c\u800c\u4e14\u5c31\u7b49\u4e8e\u5f53\u524d\u914d\u7f6e\u7684\u8fd9\u4e2a\u53c2\u6570\u7684\u503c"))),(0,o.kt)("li",{parentName:"ol"},"\u83b7\u53d6\u5207\u7247\u4fe1\u606f\u7684API\uff1a")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"// \u83b7\u53d6\u5207\u7247\u7684\u6587\u4ef6\u540d\u79f0\nString name = inputSplit.getPath().getName()\n\n//\u6839\u636e\u6587\u4ef6\u7c7b\u578b\u83b7\u53d6\u5207\u7247\u4fe1\u606f\nFileSplit inputSplit = (FileSplit) context.getInputSplit()\n")),(0,o.kt)("h3",{id:"4-fileinputformat\u5b9e\u73b0\u7c7b"},"4. FileInputFormat\u5b9e\u73b0\u7c7b\uff1a"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u601d\u8003\uff1a\u5728\u8fd0\u884cMapReduce\u7a0b\u5e8f\u65f6\uff0c\u8f93\u5165\u7684\u6587\u4ef6\u683c\u5f0f\u5305\u62ec\uff1a\u57fa\u4e8e\u884c\u7684\u65e5\u5fd7\u6587\u4ef6\u3001\u4e8c\u8fdb\u5236\u683c\u5f0f\u6587\u4ef6\u3001\u6570\u636e\u5e93\u8868\u7b49\u3002\u90a3\u4e48\uff0c\u9488\u5bf9\u4e0d\u540c\u7684\u6570\u636e\u7c7b\u578b\uff0cMapReduce\u662f\u5982\u4f55\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u7684\u5462\uff1f")),(0,o.kt)("p",null,"FileInputFormat\u5e38\u89c1\u7684\u63a5\u53e3\u5b9e\u73b0\u7c7b\u5305\u62ec\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"TextInputFormat"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"KeyValueTextInputFormat")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"NLineInputFormat")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"CombineTextInputFormat"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u81ea\u5b9a\u4e49InputFormat")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u7b49\u7b49"))),(0,o.kt)("h4",{id:"1-textinputformat"},"1. TextInputFormat\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"TextInputFormat\u662f\u9ed8\u8ba4\u7684FileInputFormat\u5b9e\u73b0\u7c7b"),(0,o.kt)("li",{parentName:"ol"},"\u6309\u884c\u8bfb\u53d6\u6bcf\u6761\u8bb0\u5f55"),(0,o.kt)("li",{parentName:"ol"},"\u952e \u662f\u5b58\u50a8\u8be5\u884c\u5728\u6574\u4e2a\u6587\u4ef6\u4e2d\u7684\u8d77\u59cb\u5b57\u8282",(0,o.kt)("strong",{parentName:"li"},"\u504f\u79fb\u91cf"),"\uff0c ",(0,o.kt)("strong",{parentName:"li"},"LongWritable\u7c7b\u578b")),(0,o.kt)("li",{parentName:"ol"},"\u503c \u662f\u8fd9\u884c\u7684\u5185\u5bb9\uff0c\u4e0d\u5305\u62ec\u4efb\u4f55\u884c\u7ec8\u6b62\u7b26\uff08\u6362\u884c\u7b26\u548c\u56de\u8f66\u7b26\uff09\uff0c",(0,o.kt)("strong",{parentName:"li"},"Text\u7c7b\u578b"))),(0,o.kt)("p",null,"\u6bcf\u6761\u8bb0\u5f55\u8868\u793a\u4e3a\u4ee5\u4e0b\u952e/\u503c\u5bf9\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"(0,Rich learning form)\n(20,Intelligent learning engine)\n(49,Learning more convenient)\n(74,From the real demand for more close to the enterprise)\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u7f3a\u70b9\uff1a"),(0,o.kt)("p",{parentName:"blockquote"},"\u6846\u67b6\u9ed8\u8ba4\u7684TextInputFormat\u5207\u7247\u673a\u5236\u662f\u5bf9\u4efb\u52a1\u6309\u6587\u4ef6\u89c4\u5212\u5207\u7247\uff0c",(0,o.kt)("strong",{parentName:"p"},"\u4e0d\u7ba1\u6587\u4ef6\u591a\u5c0f\uff0c\u90fd\u4f1a\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u5207\u7247\uff0c\u90fd\u4f1a\u4ea4\u7ed9\u4e00\u4e2aMapTask")),(0,o.kt)("p",{parentName:"blockquote"},"\u8fd9\u6837\u5982\u679c\u6709\u5927\u91cf\u5c0f\u6587\u4ef6\uff0c\u5c31\u4f1a\u4ea7\u751f\u5927\u91cf\u7684MapTask\uff0c\u5904\u7406\u6548\u7387\u6781\u5176\u4f4e\u4e0b")),(0,o.kt)("h4",{id:"2-combinetextinputformat"},"2. CombineTextInputFormat\uff1a"),(0,o.kt)("p",null,"CombineTextInputFormat\u7528\u4e8e\u5c0f\u6587\u4ef6\u8fc7\u591a\u7684\u573a\u666f\uff0c\u5b83\u53ef\u4ee5",(0,o.kt)("strong",{parentName:"p"},"\u5c06\u591a\u4e2a\u5c0f\u6587\u4ef6\u4ece \u903b\u8f91 \u4e0a\u89c4\u5212\u5230\u4e00\u4e2a\u5207\u7247\u4e2d"),"\uff0c\u8fd9\u6837\uff0c\u591a\u4e2a\u5c0f\u6587\u4ef6\u5c31\u53ef\u4ee5\u4ea4\u7ed9\u4e00\u4e2aMapTask\u5904\u7406"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"CombineTextInputFormat.setMaxInputSplitSize(job, 4194304); // 4m\n")),(0,o.kt)("p",null,"\u6ce8\u610f\uff1a",(0,o.kt)("strong",{parentName:"p"},"\u865a\u62df\u5b58\u50a8\u5207\u7247\u6700\u5927\u503c\u8bbe\u7f6e\u6700\u597d\u6839\u636e\u5b9e\u9645\u7684\u5c0f\u6587\u4ef6\u5927\u5c0f\u60c5\u51b5\u6765\u8bbe\u7f6e\u5177\u4f53\u7684\u503c")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u865a\u62df\u5b58\u50a8\u8fc7\u7a0b\uff1a")),(0,o.kt)("p",null,"\u5c06\u8f93\u5165\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u5927\u5c0f\uff0c\u4f9d\u6b21\u548c\u8bbe\u7f6e\u7684setMaxInputSplitSize\u503c\u6bd4\u8f83\uff1a"),(0,o.kt)("p",null,"\u5982\u679c\u4e0d\u5927\u4e8e\u8bbe\u7f6e\u7684\u6700\u5927\u503c\uff0c\u903b\u8f91\u4e0a\u5212\u5206\u4e00\u4e2a\u5757"),(0,o.kt)("p",null,"\u5982\u679c\u8f93\u5165\u6587\u4ef6\u5927\u4e8e\u8bbe\u7f6e\u7684\u6700\u5927\u503c\u4e14\u5927\u4e8e\u4e24\u500d\uff0c\u90a3\u4e48\u4ee5\u6700\u5927\u503c\u5207\u5272\u4e00\u5757\uff1b",(0,o.kt)("strong",{parentName:"p"},"\u5f53\u5269\u4f59\u6570\u636e\u5927\u5c0f\u8d85\u8fc7\u8bbe\u7f6e\u7684\u6700\u5927\u503c\u4e14\u4e0d\u5927\u4e8e\u6700\u5927\u503c2\u500d\uff0c\u6b64\u65f6\u5c06\u6587\u4ef6\u5747\u5206\u62102\u4e2a\u865a\u62df\u5b58\u50a8\u5757\uff08\u9632\u6b62\u51fa\u73b0\u592a\u5c0f\u5207\u7247\uff09")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"\u5207\u7247\u8fc7\u7a0b\uff1a")),(0,o.kt)("p",null,"\u5224\u65ad\u865a\u62df\u5b58\u50a8\u7684\u6587\u4ef6\u5927\u5c0f\u662f\u5426\u5927\u4e8e",(0,o.kt)("strong",{parentName:"p"},"setMaxInputSplitSize"),"\u503c\uff0c\u5927\u4e8e\u7b49\u4e8e\u5219\u5355\u72ec\u5f62\u6210\u4e00\u4e2a\u5207\u7247"),(0,o.kt)("p",null,"\u5982\u679c\u4e0d\u5927\u4e8e\u5219\u8ddf\u4e0b\u4e00\u4e2a\u865a\u62df\u5b58\u50a8\u6587\u4ef6\u8fdb\u884c\u5408\u5e76\uff0c\u5171\u540c\u5f62\u6210\u4e00\u4e2a\u5207\u7247"),(0,o.kt)("h4",{id:"3-combinetextinputformat-\u5b9e\u6218"},"3. CombineTextInputFormat \u5b9e\u6218\uff1a"),(0,o.kt)("h5",{id:"1-\u9700\u6c42"},"1. \u9700\u6c42\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u8f93\u5165\u6570\u636e\uff1a4\u4e2a\u5c0f\u6587\u4ef6\uff086kb \u4ee5\u4e0b\uff09"),(0,o.kt)("li",{parentName:"ol"},"\u671f\u671b\uff1a\u4e00\u4e2a\u5207\u7247\u5904\u74064\u4e2a\u6587\u4ef6")),(0,o.kt)("h5",{id:"2-\u5b9e\u73b0"},"2. \u5b9e\u73b0\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u4e0d\u505a\u4efb\u4f55\u5904\u7406\uff0c\u8fd0\u884c ",(0,o.kt)("strong",{parentName:"li"},"WordCount")," \u6848\u4f8b\u7a0b\u5e8f\uff0c\u89c2\u5bdf\u5207\u7247\u4e2a\u6570\u4e3a 4")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"number of splits:4\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"\u5728 ",(0,o.kt)("strong",{parentName:"li"},"WordcountDriver")," \u4e2d\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\uff0c\u8fd0\u884c\u7a0b\u5e8f\uff0c\u5e76\u89c2\u5bdf\u8fd0\u884c\u7684\u5207\u7247\u4e2a\u6570\u4e3a3",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"\u9a71\u52a8\u7c7b\u4e2d\u6dfb\u52a0\u4ee3\u7801\u5982\u4e0b\uff1a")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"// \u5982\u679c\u4e0d\u8bbe\u7f6eInputFormat\uff0c\u5b83\u9ed8\u8ba4\u7528\u7684\u662fTextInputFormat.class\njob.setInputFormatClass(CombineTextInputFormat.class);\n\n//\u865a\u62df\u5b58\u50a8\u5207\u7247\u6700\u5927\u503c\u8bbe\u7f6e4m\nCombineTextInputFormat.setMaxInputSplitSize(job, 4194304);\n")),(0,o.kt)("p",null,"\u200b\t\t\t2. \u8fd0\u884c\u5982\u679c\u4e3a3\u4e2a\u5207\u7247"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"number of splits:3\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"\u5728 ",(0,o.kt)("strong",{parentName:"li"},"WordcountDriver")," \u4e2d\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\uff0c\u8fd0\u884c\u7a0b\u5e8f\uff0c\u5e76\u89c2\u5bdf\u8fd0\u884c\u7684\u5207\u7247\u4e2a\u6570\u4e3a1",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"\u9a71\u52a8\u7c7b\u4e2d\u6dfb\u52a0\u4ee3\u7801\u5982\u4e0b\uff1a")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"// \u5982\u679c\u4e0d\u8bbe\u7f6eInputFormat\uff0c\u5b83\u9ed8\u8ba4\u7528\u7684\u662fTextInputFormat.class\njob.setInputFormatClass(CombineTextInputFormat.class);\n\n//\u865a\u62df\u5b58\u50a8\u5207\u7247\u6700\u5927\u503c\u8bbe\u7f6e4m\nCombineTextInputFormat.setMaxInputSplitSize(job, 20971520);\n")),(0,o.kt)("p",null,"\u200b\t\t\t2. \u8fd0\u884c\u5982\u679c\u4e3a3\u4e2a\u5207\u7247"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"number of splits:1\n")))}c.isMDXComponent=!0},70620:function(t,e,n){e.Z=n.p+"assets/images/20220420154547-afdf742e571f961a0730b5780cc0fb75.png"},48074:function(t,e,n){e.Z=n.p+"assets/images/20220420154740-2545b87fcfc1767effa0f22aec34c959.png"}}]);